:8080 {
    log {
        output stdout
        level DEBUG
    }

    # API and WebSocket routes to backend
    @eventPath {
        path /_event
        path /_event/
        path /_event/*
    }
    handle @eventPath {
        reverse_proxy localhost:8000
    }
    
    handle /ping {
        reverse_proxy localhost:8000
    }
    
    @uploadPath {
        path /_upload
        path /_upload/
        path /_upload/*
    }
    handle @uploadPath {
        reverse_proxy localhost:8000
    }
    
    # Static files
    handle {
        root * /app/.web/build/client
        try_files {path} {path}/ /index.html
        file_server
    }
}
