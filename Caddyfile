:{$PORT} {
    # Logs
    log {
        output stdout
    }

    # Backend Reflex - WebSocket et API
    @backend path /_event* /ping /_upload*
    reverse_proxy @backend 127.0.0.1:8000 {
        # Support WebSocket
        header_up Connection {http.request.header.Connection}
        header_up Upgrade {http.request.header.Upgrade}
    }

    # Frontend statique
    root * /app/.web/_static
    try_files {path} {path}/ /index.html
    file_server

    # Compression
    encode gzip
}